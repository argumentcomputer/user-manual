<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Lurk is a Lisp - Lurk User Manual</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="01-intro.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="02-setup.html"><strong aria-hidden="true">2.</strong> Setup</a></li><li class="chapter-item expanded "><a href="03-lisp.html" class="active"><strong aria-hidden="true">3.</strong> Lurk is a Lisp</a></li><li class="chapter-item expanded "><a href="04-ff.html"><strong aria-hidden="true">4.</strong> Finite fields</a></li><li class="chapter-item expanded "><a href="05-commits.html"><strong aria-hidden="true">5.</strong> Commitments</a></li><li class="chapter-item expanded "><a href="06-packages.html"><strong aria-hidden="true">6.</strong> Packages</a></li><li class="chapter-item expanded "><a href="07-spec.html"><strong aria-hidden="true">7.</strong> Language specification</a></li><li class="chapter-item expanded "><a href="08-binary.html"><strong aria-hidden="true">8.</strong> The lurk binary</a></li><li class="chapter-item expanded "><a href="09-coprocessors.html"><strong aria-hidden="true">9.</strong> Coprocessors</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Lurk User Manual</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/argumentcomputer/user-manual" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="lurk-is-a-lisp"><a class="header" href="#lurk-is-a-lisp">Lurk is a Lisp</a></h1>
<p>Since Lurk is a Lisp, it has practically no syntax and expressions can be formed with simple rules.</p>
<p>The expression <code>3</code> is self-evaluating.</p>
<pre><code>user&gt; 3
[1 iteration] =&gt; 3
</code></pre>
<p>When an expression is evaluated, you should see a response with the result and an iteration count, in this case, 1.
You can think of this as representing the "cost" or number of "clock cycles" required to evaluate the expression.
In the simplest case of a self-evaluating expression, only a single iteration is required.</p>
<p>Characters and strings are also self-evaluating.</p>
<pre><code>user&gt; 'a'
[1 iteration] =&gt; 'a'
user&gt; "abc"
[1 iteration] =&gt; "abc"
</code></pre>
<p>Lists are evaluated by treating the first element as a potential function (more on functions later) and the rest as its arguments.</p>
<pre><code>user&gt; (+ 2 3)
[3 iterations] =&gt; 5
</code></pre>
<p>Technically, <code>+</code> is a built-in operator: it does not evaluate to a Lurk function but behaves like one here.</p>
<p>Built-in operators cannot be independently evaluated.</p>
<pre><code>user&gt; +
Evaluation encountered an error after 1 iteration
</code></pre>
<p>A list whose first element is neither a built-in operator nor evaluates to a function yields an error when evaluated.</p>
<pre><code>user&gt; (1 2 3)
Evaluation encountered an error after 1 iteration
</code></pre>
<p>This is because lists are evaluated by first evaluating each element of the list (in order), then treating the first result as a function to be applied to the remaining.
The case above triggers an error because the number <code>1</code> does not name a function nor an operator.</p>
<h2 id="nil-and-t"><a class="header" href="#nil-and-t"><code>nil</code> and <code>t</code></a></h2>
<p><code>nil</code> and <code>t</code> are self-evaluating symbols.</p>
<pre><code>user&gt; nil
[1 iteration] =&gt; nil
user&gt; t
[1 iteration] =&gt; t
</code></pre>
<p><code>nil</code> carries the semantics of "false".</p>
<pre><code>user&gt; (= 1 2)
[3 iterations] =&gt; nil
user&gt; (if nil 1 2)
[3 iterations] =&gt; 2
</code></pre>
<p><code>t</code> carries the semantics of "true".</p>
<pre><code>user&gt; (= 1 1)
[3 iterations] =&gt; t
user&gt; (if t 1 2)
[3 iterations] =&gt; 1
</code></pre>
<h2 id="more-on-lists"><a class="header" href="#more-on-lists">More on lists</a></h2>
<p>Pairs are constructed with <code>cons</code>, and their elements are separated by a <code>.</code> when printed.</p>
<pre><code>user&gt; (cons 1 2)
[3 iterations] =&gt; (1 . 2)
</code></pre>
<p>A pair whose second element is <code>nil</code> is said to form a list with one element.</p>
<pre><code>user&gt; (cons 1 nil)
[3 iterations] =&gt; (1)
</code></pre>
<p>And we can left-expand this list by consing an element as its new head.</p>
<pre><code>user&gt; (cons 0 (cons 1 nil))
[6 iterations] =&gt; (0 1)
</code></pre>
<p>Thus, within this design, <code>nil</code> can be used to represent the empty list.</p>
<p>To deconstruct a pair, we can use <code>car</code> and <code>cdr</code>, which return the first and the second element respectively.</p>
<pre><code>user&gt; (car (cons 1 2))
[5 iterations] =&gt; 1
user&gt; (cdr (cons 1 2))
[5 iterations] =&gt; 2
</code></pre>
<p>And in our abstraction of lists, we say that <code>car</code> and <code>cdr</code> return the list's head and tail respectively.</p>
<pre><code>user&gt; (car (cons 0 (cons 1 nil)))
[8 iterations] =&gt; 0
user&gt; (cdr (cons 0 (cons 1 nil)))
[8 iterations] =&gt; (1)
</code></pre>
<p>By definition, <code>(car nil)</code> and <code>(cdr nil)</code> return <code>nil</code>.</p>
<pre><code>user&gt; (car nil)
[2 iterations] =&gt; nil
user&gt; (cdr nil)
[2 iterations] =&gt; nil
</code></pre>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<p>A Lurk function can be created by using the <code>lambda</code> built-in operator, which requires a list of arguments and a function body.</p>
<pre><code>user&gt; (lambda (x) (+ x 1))
[1 iteration] =&gt; &lt;FUNCTION (x) (+ x 1)&gt;
</code></pre>
<p>Then we can write function applications by using lists, as mentioned before.</p>
<pre><code>user&gt; ((lambda (x) (+ x 1)) 10)
[7 iterations] =&gt; 11
</code></pre>
<p>Functions with multiple arguments follow the same input design.</p>
<pre><code>user&gt; ((lambda (x y) (+ x y)) 3 5)
[14 iterations] =&gt; 8
</code></pre>
<p>Lurk supports partial applications, so we can apply arguments one by one if we want.</p>
<pre><code>user&gt; (((lambda (x y) (+ x y)) 3) 5)
[13 iterations] =&gt; 8
</code></pre>
<p>Functions can also be recursive and call themselves by their names.
But how do we name functions?</p>
<h3 id="bindings"><a class="header" href="#bindings">Bindings</a></h3>
<p>We'll come back to recursive functions in a bit.
First, let's see how <code>let</code> allows us to introduce varible bindings.</p>
<pre><code>user&gt; (let ((a 1)) a)
[3 iterations] =&gt; 1
</code></pre>
<p><code>let</code> consumes a list of bindings and the final expression, which can use the introduced variables (or not).</p>
<pre><code>user&gt; 
(let ((a 1)
      (b 2)
      (c 3))
  (+ a b))
[15 iterations] =&gt; 3
</code></pre>
<p>When defining the value bound to a variable, we can use the variables that were previously bound.</p>
<pre><code>user&gt; 
(let ((a 1)
      (b (+ a 1)))
  b)
[8 iterations] =&gt; 2
</code></pre>
<p>Later bindings shadow previous ones.</p>
<pre><code>user&gt;
(let ((a 1)
      (a 2))
  a)
[5 iterations] =&gt; 2
</code></pre>
<p>And inner bindings shadow outer ones.</p>
<pre><code>user&gt; 
(let ((a 1))
  (let ((a 2)) a))
[5 iterations] =&gt; 2
</code></pre>
<p>Now we can bind functions to variables.</p>
<pre><code>user&gt;
(let ((succ (lambda (x) (+ x 1))))
  (succ 10))
[9 iterations] =&gt; 11
</code></pre>
<p>So can we create a looping recursive function yet?</p>
<pre><code>user&gt; 
(let ((loop (lambda (x) (loop x))))
  (loop 0))
Evaluation encountered an error after 8 iterations
</code></pre>
<p>In a <code>let</code> expression, free variables are expected to be already available by, for instance, being defined on a previous binding.</p>
<pre><code>user&gt; 
(let ((loop (lambda (x) 42))
      (loop (lambda (x) (loop x))))
  (loop 0))
[13 iterations] =&gt; 42
</code></pre>
<p>In the example above, the body of the second binding for <code>loop</code> simply calls the previous definition of <code>loop</code>.</p>
<p>If we want to define recursive functions, we need to use <code>letrec</code>.</p>
<p>Warning: the following expression actually loops forever!</p>
<pre><code>user&gt; 
(letrec ((loop (lambda (x) (loop x))))
  (loop 0))
</code></pre>
<p>And now we can finally write a recursive function that computes the sum of the first <code>n</code> numbers.</p>
<pre><code>user&gt; 
(letrec ((sum-upto (lambda (n) (if (= n 0)
                                   0
                                   (+ n (sum-upto (- n 1)))))))
  (sum-upto 5))
[92 iterations] =&gt; 15
</code></pre>
<h2 id="higher-order-functions"><a class="header" href="#higher-order-functions">Higher-order functions</a></h2>
<p>Lurk supports <a href="https://en.wikipedia.org/wiki/Higher-order_function">Higher-order functions</a>.
That is, Lurk functions can receive functions as input and return functions as output, allowing for a wide range of expressive functional programming idioms.</p>
<pre><code>user&gt; 
(letrec ((map (lambda (f list)
                (if (eq list nil)
                    nil
                    (cons (f (car list))
                          (map f (cdr list))))))
         (square (lambda (x) (* x x))))
  (map square '(1 2 3 4 5)))
[186 iterations] =&gt; (1 4 9 16 25)
</code></pre>
<p>By the way, how was the list <code>(1 2 3 4 5)</code> produced so easily?</p>
<h2 id="quoting"><a class="header" href="#quoting">Quoting</a></h2>
<p>The <code>quote</code> built-in operator skips the reduction of its argument and returns it <em>as it is</em>.</p>
<p>We've seen that trying to reduce <code>(1 2 3)</code> doesn't work.
But if we want Lurk not to face that list as a function application, we can use <em>quoting</em>.</p>
<pre><code>user&gt; (quote (1 2 3))
[1 iteration] =&gt; (1 2 3)
</code></pre>
<p>And we can use <code>'</code> as syntax sugar for brevity.</p>
<pre><code>user&gt; '(1 2 3)
[1 iteration] =&gt; (1 2 3)
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="02-setup.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="04-ff.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="02-setup.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="04-ff.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
